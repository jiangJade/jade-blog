(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{403:function(n,e,s){"use strict";s.r(e);var a=s(3),t=Object(a.a)({},function(){var n=this,e=n.$createElement,s=n._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h2",{attrs:{id:"_2-eventhub-发布-订阅"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-eventhub-发布-订阅","aria-hidden":"true"}},[n._v("#")]),n._v(" 2 EventHub(发布-订阅)")]),n._v(" "),s("p",[n._v("实现思路")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("    使用一个对象作为缓存\n    on负责把方法注册到缓存的EventName对应的数组\n    emit负责遍历触发EventName底下的方法数组\n    off找到方法的索引，并删除\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("    class EventHub {\n        cache = {};\n        on(eventName, fn) {\n            this.cache[eventName] = this.cache[eventName] || [];\n            this.cache[eventName].push(fn);\n        }\n        emit(eventName) {\n            this.cache[eventName].forEach(fn => fn());\n        }\n        off(eventName, fn) {\n            const index = indexOf(this.cache[eventName], fn);\n            if(index === -1) return;\n            this.cache[eventName].splice(index, 1);\n        }\n    }\n    function indexOf(arr, item) {\n        if(arr === undefined) return -1;\n        let index = -1;\n        for(let i = 0; i<arr.length; ++i) {\n            if(arr[i] === item) {\n                index = i;\n                break;\n            }\n        }\n        return index;\n    }\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br")])])])},[],!1,null,null,null);e.default=t.exports}}]);